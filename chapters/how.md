# どう報告すればいいのか分からない

フィードバックしたいOSSとフィードバックしたい内容、そして、フィードバックする先が決まりました。ここからは、実際にイシュートラッカーやメーリングリストに「報告」というフィードバックを行う際のノウハウ、特に*開発者コミュニティの目的から導かれる「適切な、書くべき報告の内容」*をご紹介していきます。

ただ、ここで説明する内容はそんなに特別な話ではありません。最も重要なことは、*開発者の負担が減るような報告を心がけよう*ということです。

もしあなたがすでにソフトウェア開発の現場で仕事をしているのなら、あるいは、自分で作ったソフトウェアをある程度の期間に渡ってメンテナンスし続けているなら、不具合の修正に日々苦労しているのではないでしょうか。そんなときに*「こういう情報があると助かるのになあ」と思うような情報*こそが、報告に含めたほうがよい情報なのです。


## 報告に欠かせない3つの基本要素

開発者コミュニティの目的は、ソフトウェアの改善・改良、ソフトウェアの問題を解決することです。よって、報告する内容もそれに沿って整理する必要があります。しかし、一体どんな情報があれば問題解決の役に立つのでしょうか？

一般的に「報告に必ず盛り込むべき要素」とされるのは以下の3点です。

* 再現手順（Steps to reproduce）
* 実際に得られる結果（Actual result）
* 期待される結果（Expected result）

ソフトウェア開発に関わると実感することですが、このどれが欠けても、問題の解決は途端に難しくなります。この3要素は、マクロなシステムからミクロな関数まであらゆる規模の「問題」を簡潔に記述し表現するための基本原則と言えます。

（イラスト：1本でも2本でも立たないが3本の脚が揃うと容易に自立する、三脚に例えた絵）

プロジェクトによっては報告の仕方の案内の中で報告の書き方・形式を定めている場合がありますが、十中八九どのプロジェクトでも、表現の仕方や順番は異なっていても[^variations-of-report-information]この3要素は必ず含めるように指定されています。

[^variations-of-report-information]: 例えば「実際に得られる結果」→「起こったこと」「現象」、「再現手順」→「やったこと」、「期待される結果」→「起こって欲しいこと」のような表現になっている場合があります。

報告には他にも、以下のような情報を添える場合もあります。

* 不具合の報告か、新機能の要望か
* セキュリティ上の脆弱性かどうか
* 影響度はどのくらいの大きさか、どの程度深刻か
* どのモジュールに関する報告か

ただ、*基本の3要素が揃っていないのに他の情報ばかり書くのはお薦めしません*。プロジェクトの運営方針によっては、最低限基本の3要素が揃っていない報告は、「運用ルール上の要件を満たしていない」「基本の3要素を明らかにする努力をしてくれず、プロジェクトに非協力的」として一律に却下される場合もあります。慣れないうちは特に、「その問題のせいで自分がいかに困っているか」「その問題の影響度はどのくらいか」ということを一生懸命書いてしまいたくなるところですが、その気持ちはグッとこらえて、まずは基本の3要素を書くところから注力しましょう。


## 再現条件を特定しよう

報告の基本の3要素のうち、労力的に最も大きなウェイトを占めるのが*再現手順*です。実際に、ソフトウェア開発において不具合の修正に要する時間のほとんどは、発生条件の特定に費やされていると言っても過言ではないでしょう。不具合の報告の場合、*それが修正に繋がるかどうかは、「確実に現象が再現する手順」を特定できるかどうかでほぼ決まります*。

しかし、再現手順といってもどう書けばよいのでしょうか。例として、筆者が実際にFirefoxに対して行った「ウィンドウコントロール[^window-control]が消えてしまう」という問題の[報告](https://bugzilla.mozilla.org/show_bug.cgi?id=1521688)に記載した再現手順を見てみましょう。

[^window-control]: Windowsではウィンドウの右上にある「最小化」「最大化」「閉じる」の3つのボタンのこと。

1. Windows 7またはWindows 10が動作する環境を用意する。
2. Firefox 65.0b12またはNightly 66.0a1をインストールする。
3. Firefoxを起動する。
4. ツールバーの上で右クリックして、メニューの中の「メニューバー」にチェックを入れ、メニューバーを常に表示する状態にする。
5. キーボードショートカット「Ctrl-Shift-K」を入力して、Webコンソールを開く。
6. コンソールに「window.open('about:blank','_blank','toolbar')」と入力して、Enterキーを押す。
7. ポップアップウィンドウがFirefoxのポップアップブロッカーによってブロックされるので、「このサイト（～）によるポップアップを許可する」をクリックする。

この後、期待される結果として「ウィンドウコントロールを伴ってウィンドウが開かれる」、実際の結果として「ウィンドウコントロールが無いウィンドウが開かれる」が続きます。

この手順の1と2では「現象が再現する前提条件」を整えていますが、複数のバージョン・複数の環境で同じ現象が起こるこのようなケースでは、ひと続きの手順の中に書くとややこしくなる場合もあります。そういう場合、*前提条件にあたる部分は再現手順とはとして別立てで記載する*のもよいでしょう。実際に、筆者が行った報告でも1と2は再現手順の中には含めず、見出しを分けて後段で「現象が再現する環境（OSとそのバージョン）」「現象が再現するFirefoxのバージョン」として別途記載しています。また、万が一にも誤解が無いようにと、念のため以下のように*問題発生時の状況を示すスクリーンショット*も添えました。

（画像：添付されたスクリーンショット）

この「再現手順」を書くにあたって筆者が気をつけたのは、*開発者が戸惑わないように、情報を多めに盛り込む*ということです。


### どの程度細かく書けばいい？

前提条件や再現手順をどの程度の粒度で書くかはセンスが問われる部分ですが、基本的には、*自分で「細かすぎる」と思うくらいに細かく書くように意識する*のがよいです。というのも、*報告に不慣れな人ほど、荒く・情報が不足した報告を書いてしまいがち*だからです。

例えば、先の例は報告の初心者なら以下のように書いてしまうかもしれません。

1. ポップアップウィンドウを開く。

以上、たった1行でおしまいです。この後には何も続きません。「まさかそんな馬鹿な！？」と思うかもしれませんが、実際にこういう報告はよくあります。なぜこうなってしまうかというと、報告者にとっての「自分がやったことのうち、自分が意識している範囲のこと」だけを言葉にしたためです。

ちょっと待ってください、「報告者にとっての」？　はい、「誰にとっての」という所が実は重要なんです。ここまでは単に「再現手順」とだけ書いていましたが、実際には、報告に書く必要があるのは*開発者が現象を手元で再現するための手順*なのです。*再現手順の説明の主語は「報告者であるあなた」ではなく「その報告を読んで試す開発者」にする必要がある*、このことを意識するのが「よい再現手順」を書くためのコツです。

（イラスト：報告者の脳内にあるさまざまな前提＋端的な報告では意味が通っても、開発者の元に届いた端的な報告では意味が通らなくなってしまう、という様子）

「報告者の自分にとっては当たり前でも、それを読む開発者にとっては当たり前ではない」という情報は非常に多いです。例えば先の例でも、報告者と開発者の間では以下のようなすれ違いが起こるかもしれません。

* あなたはWindowsを使っているかもしれませんが、開発者はmacOSを使っているかもしれません。
* 「Webコンソールを開く」とき、あなたはキーボードで操作するかもしれませんが、開発者はメニューから項目を選んで行うかもしれません。
* メニューを選択するとき、あなたはいつものようにキーボードで操作するかもしれませんが、開発者はマウスで操作するかもしれません。
* 「ポップアップウィンドウを開く」という操作は、あなたにとっては勤務先の社内システムでいつもの操作をするだけかもしれませんが、開発者はSNSのWebサイトで操作するかもしれません。
* あなたは10年以上使い込んだ設定を伴ってFirefoxを使っているかもしれませんが、開発者はまっさらな新規の設定でFirefoxを起動するかもしれません。
* あなたはポップアップブロック機能を無効にしているかもしれませんが、開発者はポップアップブロック機能を使っているかもしれません。
* あなたはそれを「ウィンドウコントロール」と呼んでいるかもしれませんが、開発者は「ウィンドウボタン」と呼んでいるかもしれません。
* あなたが「最新版」と思っている物は、開発者にとっての「最新版」ではないかもしれません。あなたは「一般に公開されている最新版」を使っていて、開発者は「まだリリースされていない開発中の最新版」を使っているかもしれません。

同じことが、「実際に得られる結果」や「期待される結果」の説明でも言えます。

* あなたが「当然こうなるはずだ」と思う内容と、開発者が「当然こうなるだろう」と思っている内容は、違うかもしれません。
* あなたが「これはおかしい」と思う内容は、開発者にとっては「当然そうあるべきだ」と思える内容かもしれません。
* あなたが専門知識に基づいて「当然こうでなければならない」と思う内容は、開発者にとっては「なんでそうなの？」と思う内容かもしれません。開発者はあなたよりその分野に詳しくないかもしれません。

（イラスト：報告者と開発者の間で想像している物がことごとく異なっている様子）

あなたは、初めての報告をすっきりスマートに済ませたいと思うかもしれません。端的に簡潔に書いた方が良いに違いない、あまりクドクド書いても迷惑になるだろう、と気を回したくなる気持ちはよく分かります。筆者もかつてはそう考えていた時期がありました。

ですが、あなたと開発者が別の人間である以上、あらゆる所で認識の齟齬は発生し得ます。下手に省略して伝わらない報告になってしまうよりも、不格好でも必要な情報が漏れなく書かれている報告のほうが、開発者にとってはずっと有用でありがたいものなのです。

報告するときは、自分にとっての*「当然」を疑って*、普段サラッと流していることでも*解像度を上げて*見直して、「こんなこと説明しなくても伝わるだろう」と思っているようなことほど*意識的に言葉にするよう心がけましょう*。


### まっさらな環境での再現手順

報告者と開発者の間で環境も設定も全然違うかもしれない、それじゃあ一体何を前提に説明すればいいんだ！　と頭を抱える人もいるかもしれません。そこで説明の出発点になるのが、いわゆる「クリーンな環境」「まっさらな環境」という考え方です。設定を一切変更していない、ソフトウェアを初めてインストールし、初めて起動した直後の状態がこれにあたります。







### 画像や動画も使っていい



あるいは、ここまでやるならむしろ*フローチャートの図*で情報を示してもいいかもしれません。そう、説明する方法は「英語の文章」でなくてもいいのです。スクリーンショットで示した方が早ければ*スクリーンショットに丸や矢印を描き込んだ物を添付してもいい*ですし、静止画では説明が難しければ[スクリーンキャストをYouTubeあたりにアップロードして伝えてもいい](20180731)です。あるいは、


### 実際に動かせる物があると、なおよい



プログラムやデータを実際に作れるのであれば、*それを使って実行すれば必ず現象が再現するというテストケース*を添付するのが一番いいです。

Dockerコンテナ




## 「Regression Window」を特定しよう




