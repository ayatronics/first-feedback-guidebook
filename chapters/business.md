# 仕事が忙しくてOSS活動に時間を割けない！

「OSSの開発に関わるのはとても有意義だと分かってはいるけど、プライベートな時間や睡眠時間が削られてしまうのが辛い……」という声はよく聞かれます。筆者も、OSS以外にも映画も見たければ遊びにも行きたいという思いはあるので、気持ちはよく分かります。

もしあなたが業務上でOSSを使用しているなら、筆者としては、それらのOSSへのフィードバックを業務の範疇として認めてもらうように、上司やマネージャーに交渉してみて頂きたいです。本節では、そのような交渉の材料になるように、会社などの組織にとってのメリットを色々ご紹介します。うまくいけば、あなたも業務時間中に堂々とOSSにフィードバックできるようになるかも……？


## OSSにフィードバックすると、組織にもメリットがある

### 売名上等！

組織名を公にした状態でOSSにフィードバックするということには、*OSSに関心がある技術者に対する組織の知名度の向上や、好感度の向上*の効果が見込めます。所属組織を明らかにしているメンバーがOSSに積極的にフィードバックしていると、*「この組織はOSS開発に理解がある」「この組織に所属している技術者にはちゃんとした知識がある」ということの間接的なアピール*になるからです。

OSSプロジェクトに寄附をしたり、技術イベントにスポンサーとして資金を提供したりブースを出したりすることも、「親OSS」であることのアピールになります。しかし、ニュースリリースやイベントの時しか名前を見かけないのでは、現場の開発者の印象には残りにくいのは否めません。それに対し、イシュートラッカーやリポジトリ上でその組織の所属エンジニアが積極的に活動していると、プロジェクトの関係者やユーザーからの印象は爆上がりです。もしかしたら、*その様子を見た優秀なITエンジニアが転職先として検討してくれる*かもしれません[^recruiting]。

[^recruiting]: 実際に、そういう経緯で当社を知って応募してきて下さった方もいました。

また、技術コミュニティへ有形無形の還元をすることは、*コミュニティとの良好な関係を築く*ことにもつながります。2018年の半ば頃、蔵人ベンダーに対してRedis、MongoDB、KafkaなどのOSS製品の開発元が、これらのOSSをクラウド事業の基盤に利用して得た利益を技術コミュニティに十分に還元していないと批判して、クラウドビジネスでの商用利用を禁止する形にライセンスを変更した、ということが[話題になっていました](https://www.sbbit.jp/article/cont1/36018)。このような険悪な状況になってしまわないように、自社のビジネスで使用しているOSSにはちゃんとフィードバックしておくことをおすすめします。

このような目的でフィードバックを行うことを「売名行為だ」と非難する向きもあるかもしれません。しかし、無意味なフィードバックでかえって開発コミュニティに負担をかけてしまっている、ということでもない限り、良質で有用なフィードバックが多くもたらされることは、OSSプロジェクトにとってはありがたいものです。また、OSSの世界には「実際に手を動かす人が誰よりも正しい」という共通の価値観があります。手も動かさずに他人のことを「売名行為だ」と非難する人の言うことは、あまり気にする必要はないでしょう。

### コラム：AmazonはRedis、MongoDB、Kafkaへ何かフィードバックしていたの？

本文で触れた「クラウドベンダーが得た利益をコミュニティに十分に還元していない」という批判は、実際の所は、AWSを擁するAmazonに対して向けられたものだ、という見方をする人が多いようです。これらのプロジェクトが商用利用を制限するようライセンスを変更してから数ヶ月後、AmazonがMongoDBの古いバージョンのAPIとの互換性を謳うサービスを展開し始めたことからも、Amazonとこれらのベンダーが敵対的な状況にあるのは事実と言えそうです。

ところで、MongoDBの創業者は[声明](https://www.mongodb.com/blog/post/mongodb-now-released-under-the-server-side-public-license)の中で、「The revenue generated by a service can be a great source of funding for open source projects, far greater than what has historically been available. The reality, however, is that once an open source project becomes interesting, it is too easy for large cloud vendors to capture most of the value while contributing little or nothing back to the community.（サービスから得られる収益はオープンソースプロジェクトにとって大事な収益源だが、大手クラウドベンダーにとっては、コミュニティにほとんどコントリビュートしないかまったく還元しないでそこから価値を得ることは、あまりにたやすい）」という批判をしています。では実際の所、大手クラウドベンダーの代表と言えるAmazonはこれらのプロジェクトにどのくらいコントリビュートしていたのでしょうか？

この点でわかりやすい指標としては、プルリクエストを通じてマージされた変更の数や、それに関わった人の数が挙げられます。[筆者が実際に調べてみたところ](https://twitter.com/piro_or/status/1225229158818533377)、各プロジェクトのコントリビューターの中でコントリビュート数が多い上位100人の中で、プロフィールにはっきりと「AWS」または「Amazon」と所属を書いている人の状況は、以下のようになっていました。

| プロジェクト | 全体のコントリビューター数 | 全体のコミット数 | Amazonからのコントリビューター数 | Amazonからのコントリビューターによるコミット数 |
| ------------ | -------------------------- | ---------------- | --------------------------------- | ---------------------------------------------- |
| [Redis](https://github.com/antirez/redis) | 328人 | 8788コミット | 2人 | 33コミット |
| [MongoDB](https://github.com/mongodb/mongo) | 397人 | 50094コミット | 0人 | 0コミット |
| [Kafka](https://github.com/apache/kafka) | 623人 | 7067コミット | 1人 | 84コミット |

もしかしたら匿名でコントリビュートしている人もいるかもしれず、また、プルリクエストになっていないイシューだけでのフィードバックについては未調査なので、この数字がすべてというわけではありませんが、RedisとKafkaに関しては、まったくコントリビュートしていないわけでもないようです。少なくとも、筆者がFirefoxやThunderbirdにコントリビュートした量よりは多い気がします。

ただ、これらのOSSプロジェクトのオーナーは自身でもクラウドサービスを提供しているクラウドベンダーで、AmazonのAWSはまさに*商売敵である*、という点には注意が必要です。仮に商売敵であっても、これらのOSSプロジェクトについて各々が投じた費用の比率と、そこから得られた収益額の比率が近いのであれば、各ベンダーはこれらのOSSプロジェクトを共通の基盤として共同で開発している、という状況だと言えます。しかし実際には、クラウドベンダー業界におけるAWSのシェア占有率は、これらのプロジェクトのオーナー達に比べれば圧倒的に高いです。MongoDBの創業者が言うように、得ているリターンに対してAmazonが支払っているコストがあまりに小さすぎる、いびつな状況にあるのは間違いありません。

（イラスト：不均衡の様子）

Amazonは「良い商材をなるべく安く仕入れて、なるべく高く売る」という小売店の戦略に忠実に商売しているということを考えると、Amazonがクラウドベンダー事業を行う以上は、このような状況が発生してしまうのは必然でしょう。MongoDBの開発は2007年に開始されたそうですが、2006年にはすでにAWSがサービスを開始していたということを考えると、「すでに競合プレイヤーがいるところに、無防備に自社のコア商材を公開しながら参入してきた」MongoDBが苦戦することになるのは、当然と言えば当然と言わざるを得ない、と筆者は考えています。

なお、筆者（の所属する会社）が商売している領域は、Mozillaが直接は商売をしていない領域なので、両者は競合関係にはありません。*OSSを「使って」ビジネスをするときは、それぞれの商売上の領域を侵さないような棲み分けが大事だ*、ということは言えそうです。

### 自社製品の競争力を高め、維持するために

「うちの会社は技術コミュニティと仲良くなくてもべつに構わない。そういう所から人を採りたいとも特に思っていない。うちはOSSを使って製品やサービスの価値を高めたいだけだ……」という場合でも、フィードバックにはメリットがあります。というよりも、*フィードバックしないことにデメリットがあります*。

自社製品やサービスで使用する（依存する）OSSのライブラリやフレームワークなどには、不具合が含まれている場合があります。枯れたバージョン[^good-old-version]だけを使えばいい、と思うかもしれませんが、十分に枯れたバージョンは今のニーズに対して機能が不足していがちなので、そのままでは要件を満たせないことも珍しくないです。結局、不具合を直しながら最新の開発版を使ったり、自社製品向けに独自の改変を加えたり、といった形で何らかの変更をすることになります。

[^good-old-version]: エンジニアリングの世界では、市場に出回った後に十分な時間が経過し、不具合が修正され尽くして、運用ノウハウが十分に蓄積され、予想外のことが起こるリスクが低くなった状態のことを「枯れた」と形容します。

そういった変更はあくまで「作業を行った時点のリビジョンに対する変更」なので、そのOSSを更新すると、同じ変更を適用できなくなる場合があります。しかし、だからといって使用するOSSのバージョンを固定してしまうと、そのバージョンが致命的な脆弱性を含んでいた場合、自社製品までもが脆弱な状態が長く続いてしまいます。製品開発のプロセス上も、自社の顧客に対する責任の面でも、これはリスクです。

でも、*修正や必要な変更をフィードバックしてOSS本体に取り込んでもらっておけば、そのようなリスクを減じられます*。そうしておけば、新しいバージョンがリリースされた際も、スムーズにそのOSSの更新を自社製品に反映できます。

### GitHub社の事例に学ぼう

このような話の非常に分かりやすい例が、[2019年に行われた、GitHubでのRails 6.0への移行](https://news.mynavi.jp/article/20190910-891948/)です。

GitHubのサービスはRuby on Railsの上に構築されていますが、多くの人が利用するサービスなので、GitHub社としてはいつまでも古いRailsを使い続けるわけにはいきません。しかし、Railsの新バージョンが公開されてから移行作業を始めたのでは、まず単純に作業に時間がかかりますし、それだけでなく、*移行を始めてから発覚したRails自体の不具合や非互換の問題への対処*によっても、作業期間はどんどん延びていってしまいます。

そこでGitHub社では、Rails 6.0について*開発段階から積極的にフィードバックを行い、事前にRails側の不具合や非互換に関する懸念をあらかた解決しておく*という方針をとったそうです。これにより、あれだけの大規模のサービスであるにも関わらず、サービスで使用するRailsのバージョンの切り替え作業は、Rails 6.0の公開からわずか9日で完了できたそうです。

GitHubのようなWebサービス企業だけでなく、ハードウェア製品の開発・販売をメインとしている企業でも、同様のことが言えます。実際に、NEC・日立・富士通といった日本の大企業はLinuxカーネルに多大な貢献をしていることで知られていますが、彼らも自社製品にLinuxを組み込む都合上そうしているのであって、その目的は基本的に「自社の利益のため」なのです。


## 自社のビジネスの未来のためのフィードバック

### 自社に有利な状況は作れる（かもしれない）

フィードバックは、今ある物についてだけでなく、これから実装される機能、これからそのOSSが向かっていく方向性そのものについても行えます。

自分にとって嬉しいように社会が向かっていくように、法律や制度を作る立場の人に意見や情報を伝え、これから作られる法や制度に間接的に影響を与えていくことを*、ロビイング（ロビー活動）*と言います[^lobbying]。OSSではコードに直接変更を行っていく決定権があるのはコミット権を持つ開発者の人達なので、彼らの判断に影響を与えるよう働きかけるのは、一種のロビイングと言えるでしょう。

[^lobbying]: 例えば、営利企業は規制緩和や税制改革をしてもらおうとロビイング活動をしていますし、生活困窮者を支援する人達は社会保障制度を整備してもらおうとロビイング活動をしていますし、漫画家協会は著作権にまつわる制度の整備をしてもらおうとロビイング活動をしています。

*イシューを立てて要望を伝える*のは、典型的なロビイングです。例として、筆者が所属する株式会社クリアコードでの事例をご紹介します。

クリアコードは「Firefoxの法人向け技術サポートサービス」を提供しており、その中では、顧客企業のニーズに合わせてFirefoxをカスタマイズするということも行っています。Firefoxにおいて、「カスタマイズの自由度を下げて、[『ポリシー設定』としてある程度決まった項目のカスタマイズだけを行えるようにし](https://www.clear-code.com/blog/2018/5/12.html)、速度や安定性を向上させる」という方針での改革が進められることが決定したという報せは、クリアコードのビジネスにとっては見過ごせない情報でした。顧客企業の望むカスタマイズができないと、顧客満足度が低下し、顧客離れにつながって、ひいては会社の収益源につながるからです。

そのため、筆者は自社のビジネス上で頻出のカスタマイズ項目を「ポリシー設定」のリストの中に入れてもらうよう、イシューを立てて積極的に提案していきました。また、そのうちいくつかはパッチの提供もしました。提案のすべてが採用されたわけではありませんが、重要なものは採用してもらえたため、クリアコードは今も安心して「Firefoxを顧客企業のニーズに合わせてカスタマイズする」というサービスを提供できています。

このようなロビイングは、新しいイシューを立てるだけでなく、*すでに立てられて動き始めているイシュー*に対しても行えます。例えば、ある機能が「この機能は利用者が少ないようだ」という理由で削除されようとしているとき、「うちの顧客企業では広く使われていて、非常に重要だ」とコメントして反対票を投じる、というのはその分かりやすい例です。

### OSSでのロビイングで押さえておくべき点

このようなロビイングをするときのポイントは、いくつかあります。

何より大事なのは、*「企業の代表者」ではなく「開発コミュニティの一員」として振る舞う*ということです。

具体的には、「うちの会社ではこういうビジネスをしている。だからこうして欲しい」という言い方は避けた方がよいでしょう。というのも、そのOSSプロジェクトのスポンサーでもない限り、*外部の組織の都合に従う動機は、プロジェクト側にはほとんどない*からです。にもかかわらず会社を全面に出すというのは、「道理の通らない話をゴリ押ししようとしている」という見え方になり、非常に印象が悪いです。開発社側としては、「そんなに大事ならスポンサーになってくれ」「それか、自前でフォークしてメンテナンスしてくれ」と反感を抱いてしまいます。

そのような失敗のわかりやすい事例として、[Mozillaの証明書ストアに日本政府の公開鍵基盤（GPKI）の認証局証明書を入れてもらえなかったというエピソード](
https://it.srad.jp/story/18/03/01/072235/)があります。この事例では、日本政府を代表する立場と思しきユーザーが、Mozillaの求めるセキュリティ水準を満たさない状態であるにも関わらず、その状態を解消するための行動はしないで、ただ「日本政府」の権威のもとに要求だけを繰り返す、ということが行われていました。それに対するMozillaの対応は、「ルールに従ってくれない以上、証明書は入れない」というものでした。一国の政府だからといって、OSSの世界では特別扱いはされない、ということがこの例からは見て取れます。

そうではなく、ロビイングにあたっては、「この機能は実際にユーザーのニーズがあり、機能を入れると、*このOSSプロジェクトのユーザー全体にメリットがある*」ということを、そのような状況を知る一人の開発者として訴える、という形を取るのがよいです。筆者も、前述のポリシー設定の提案にあたってはこの点に気をつけて提案することを心がけました。筆者は詳細を追っていませんが、前述のRailsに対するGitHub社のフィードバックも、そういう形を取っていたのではないかと思っています。

（イラスト：顔の見えない大きな組織として居丈高に振る舞う場合と、一人の開発者として振る舞う場合）

もちろん、提案はあくまで提案なので、採用されないこともあります。筆者のした提案も、ユーザー全体のメリットが大きそうな物から採用され、メリットの小さい物は却下されました。そのような場合でも、捨て台詞を吐いて開発者を罵るようなことをしてはいけない、というのはすでに別項で述べたとおりです。

また、適切なタイミングでロビイングを行うためには、*日頃からの情報収集*も重要です。

イシュー上で行われている議論には、議論が行われているまさにそのとき[^realtime-discussion]に話に加わる必要があります。その時の参加者間で議論がし尽くされて決定が下ってしまった後で、ノコノコやってきて「これは困る」とコメントしても、時すでに遅しです。そのイシューでの決定を受けて、すでに実際に作業が進み始めている、という状況では、プロジェクトの翻意にはまず期待できません。

[^realtime-discussion]: といっても、口頭でのリアルタイムの議論でないため、イシュー上での議論は、短ければ数日から、長ければ数ヶ月といった時間をかけて行われることもあります。

むしろ、普段からそのOSSプロジェクトに深く関わっていて、開発者からの信頼を得られていると、「この話題については彼が詳しいから、耳に入れておいた方が良さそうだ」ということで、*プロジェクトの側から情報が回ってくる*ことすらあります。企業が著名なOSSプロジェクトのコミッターを雇用するケースは、そのような場面で自社にとって不利にならないように物事を進めてもらうための交渉役としてのはたらきに期待して、という部分もあるようです。

### 自社製品の寿命を延ばすために

資金援助や、プルリクエストなどで労力を提供するというフィードバックには、*プロジェクトの継続への寄与*という効果が期待できます。

OSSの中には、多くのプロジェクトから利用され非常に重要度が高いにもかかわらず、実際の開発やメンテナンスはたった1人の個人によって行われている、というものが度々あります。そのようなプロジェクトは、開発者の個人的な事情で突然終了してしまうことがありますが、かといってそれに代わる実装が存在しないことも多く、企業にとっては大きなリスクとなってしまいます。

実際に、様々なソフトウェアで安全な通信のために使われているライブラリであるOpenSSLについて、2014年にHeartbleedと呼ばれる深刻な脆弱性が発覚したときには、資金不足のためフルタイムの開発者は1人だけしかいない、という状況であった[^openssl-developers]ことが大きな話題となりました。

[^openssl-developers]: OpenSSLの場合、その当時はフルタイムでないコントリビューターは10人程度はいたそうです。しかし、Heartbleedの脆弱性はその状況下で2年以上気付かれずに存在していたということで、十分な開発体制でなかったということは間違いありません。

金銭的な寄付を募っているOSSであれば金銭的に支援できますが、寄付を募っていない場合、できる支援の手段は、実際に手を動かすことしかありません。そのOSSに長生きして欲しければ、積極的にフィードバックした方がよいということです。

### リスクマネジメントのためのフィードバック

ソフトウェアが高度化・複雑化している現代では、一社で製品の上から下まで構成要素すべての面倒を見続けるということは、現実的ではありません。現実的な理由からOSSを構成部品に採用する必要に迫られることは多く、OSSプロジェクトの去就がビジネスを左右してくる場面も多いです。

ある日突然ハシゴを外されてしまう、という悲劇を避けるためには、企業であってもある程度積極的にOSSに関わっていく必要があります。「社会貢献」のような美しい話でも、「攻めの経営」のようなキラキラした話でもなく、*現実的なリスクマネジメントとして、企業にはOSSに関わる動機がある*と言えます。

そう考えると、「担当者が個人的に、定時後に、あるいは深夜に、眠い目を擦りながら自分のプライベートな時間を削ってOSSに関わる」というのは、企業としてはリスクを抱えた状態と言わざるを得ません。きちんと枠を取って、定時の中で*業務の一環として責任感を持ってOSSに関われるようにする*、それが自社のビジネスために大事なことだと言えるのではないでしょうか。


## それでも「情報を外に出す」のがためらわれる場合

### 情報を外に出すと、組織にとって損になる……とは限らない

会社によっては、そういうことであっても外に情報を一切出せないという場合や、いわゆる「GPL汚染」を懸念して、OSSを持ち込むことはおろかOSSのソースコードを見ることすら禁止されているという場合もあると聞きます。秘密の情報が組織の利益の源泉になっているというケースでは、確かにそういう心配も致し方ないでしょう。

ですが、それは逆の見方をすれば、*秘密の情報以外のことで利益を出している組織にとって、OSSに関わることはそれほどリスクにはならない*ということではないでしょうか。自社の本質的な武器が「秘密のレシピ」ではなく「積み重ねてきた信用」や「時間をかけて整備されてきた体制」のように一朝一夕には真似できない部分であるという場合、OSSへのフィードバックのメリットを享受できるかもしれません。



ここまでで名前を挙げたいくつかの会社は、社名を出してOSSに関わっていますが、しかし、先に述べたようなリクルーティングや広報の目的がないのであれば、社名を表に出す必要は必ずしもありません。むしろ、ロビイングの説明で述べたように、社名を大々的に掲げて関わるのはアンチパターンにすらなり得ます。社名は出したくないがOSSに関わっておきたい、という場合でも大丈夫です。


情報漏洩のリスク
秘密鍵やパスワードの漏洩
顧客情報の漏洩



コミットの動向で会社の動向が透けて見えてしまう。
ChromiumにGoogleのエンジニアが何か積極的にコミットしていたら、何かしようとしていることの表れと考えられる。
特許の出願内容からAppleの次の製品を予測するように。


何を表に出して何を表に出さないか、意識的にコントロールすることが大事。

