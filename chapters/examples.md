# 実例で見る良いフィードバック・悪いフィードバック

ここまでの解説の中でも実際に行われたフィードバックの例をいくつか紹介してきましたが、参考として、他にもよいフィードバック・悪いフィードバックの例をいくつかご紹介しましょう。

## よいフィードバック：collectdにおけるリリースタグの不備の指摘

https://github.com/collectd/collectd/issues/3293

```
Title≪タイトル≫:
  The source packages of collectd-5.9.2 aren't generated by the formal procedure
  ≪タイトル：colelctd-5.9.2のソースパッケージが通常の手順で生成されない≫

Version of collectd: collectd-5.9.2 on git
≪collectdのバージョン：git上のcollectd-5.9.2≫

Expected behavior≪期待される結果≫:
  version-gen.sh script should generate "5.9.2" on collectd-5.9.2 tag.
  ≪version-gen.shスクリプトがcolelctd-5.9.2タグに基づいて「5.9.2」を生成する。≫

Actual behavior≪実際の結果≫:
  version-gen.sh script generates "5.9.1.7.gdfb9dd0 on collectd-5.9.2 tag.
  ≪version-gen.shスクリプトがcolelctd-5.9.2タグに基づいて「5.9.1.7.gdfb9dd0」を生成する。≫

Steps to reproduce≪再現手順≫:
  $ git clone https://github.com/collectd/collectd.git
  $ cd collectd
  $ git checkout collectd-5.9.2
  $ ./version-gen.sh

Cause of the issue≪問題の原因≫:
  collectd-5.9.2 tag isn't annotated.
  ≪collectd-5.9.2タグに注記が付いていない。≫
```

これは、筆者の同僚の足永さんがcollectdというソフトウェアに対して行ったフィードバックです。

### フィードバックの経緯

足永さんがとある案件でcollectdの独自改修版を作成して、お客さん向けに提供するためのパッケージを所定の手順で作成しようとしたところ、当時の最新リリース版である「5.9.2」からの派生版なので「5.9.2.（リビジョン番号）」というバージョン番号が自動生成されるはずが、なぜか「5.9.1.（リビジョン番号）」というバージョン番号になってしまう、という現象に遭遇しました。この原因を調べたところ、以下のことが分かりました。

* パッケージ作成用のスクリプトは、Gitリポジトリに対して打たれたタグのメッセージが特定の形式に則って書かれている場合にのみ、それを正常なバージョンとして認識するようになっている。
* バージョン5.9.2のタグのメッセージは、その形式に則っていなかった。

実際に、公開されているcollectdに対して何も変更を行っていない状態でパッケージを作成しようとしてもやはり同様の現象が発生する状態でした。そのため、足永さんはこの問題をcollectdプロジェクトで解決されるべき物として、調査結果を踏まえてフィードバックしました。

報告の後のコメントのやり取りの中で、collectdプロジェクトにおいてリリース作業の担当者が今回から変わっていたことと、前任者から手順が正しく引き継がれていなかったためにタグのメッセージが適切に設定されていない状態だったということが分かりました。

その後、問題の状態は解消され、この報告もクローズされています。

### 注目したい点

「作成されたパッケージのバージョン番号が違っている」というつまずきに遭遇したとき、暫定的な回避として「できたファイルのバージョン番号の部分をとりあえず書き換えて済ませる」というような対策を取ることが多いでしょう。そういったその場しのぎだけで終わらせずに開発元にフィードバックすると、同じ問題につまずく人が減ります。

この報告には、基本の3要素である「再現手順」「期待される結果」「実際の結果」が揃っていて、再現手順には実際に操作したコマンド列もそのまま記載されています。文章で長々と説明しなくても、要点を押さえてあれば適切に伝わるということがよく分かります。

「期待される結果」「実際の結果」の英語の表現にも着目してください。

> version-gen.sh script should generate "5.9.2" on collectd-5.9.2 tag.

「パッケージ作成手順に従って作業したら5.9.2というバージョンが付くべき」ということを言い表すのに、リポジトリに含まれているパッケージ作成用のスクリプトを主語にして「このスクリプトはこのような事をするべき」という書き方をしています。動作の主体を明記することで簡潔に表現できるという好例でしょう。

このフィードバックの面白いところは、ソフトウェアそのものの不具合というよりも、プロジェクトのリリースマネジメントへのフィードバックとなっているという点です。プロジェクトにおいて作業を複数人で分担している場合に、そのときの作業者の属人的な知識に依存したまま体制が組まれてしまっていると、他の人に作業が引き継がれた後にこのような形でトラブルが起こる場合があります。このフィードバックがなされていなければ、新しい担当者は次のリリースで同様の問題に遭遇し、原因の究明に奔走する羽目になっていたかもしれません。


## よいフィードバック：meta-clangの「MULTILIBS」への対応の要求

https://github.com/kraj/meta-clang/issues/247

```
Title≪タイトル≫:
  meta-clang's llvm-config is not compatible with MULTILIBS
  ≪meta-clangのllvm-configが、MULTILIBSと互換性がない≫

Describe the bug
≪不具合の説明≫
  One of the our target boards(RZ/G2E)'s Yocto default conf/local.conf specifies MULTILIBS = "multilib:lib32" and   DEFAULTTUNE_virtclass-multilib-lib32 = "armv7vethf-neon" to be able to run 32bit ARMv7 binaries.
  ≪私達が開発している対象のボード（RZ/G2E）の一つのYoctoレシピの既定のconf/local.confには、32bit ARMv7バイナリを動かすために、「MULTILIBS = "multilib:lib32"」と「DEFAULTTUNE_virtclass-multilib-lib32 = "armv7vethf-neon"」という設定が含まれています。≫
  So, built binaries will be installed in /usr/lib64/ instead of /usr/lib.
  ≪そのため、ビルドされたバイナリは/usr/libではなく/usr/lib64/の中にインストールされます。≫
  
  Because our SDK environment does not assume /usr/lib for library installation directory.
  ≪なぜなら、私達のSDKの環境は/usr/libをライブラリのインストール先ディレクトリーとして想定していません。≫
  Instead, /usr/lib64 is used for 64bit libraries and shared object. And /usr/lib32 is used for 32bit objects.
  ≪その代わりに、/usr/lib64は64bitライブラリと共有オブジェクトに使われます。また、/usr/lib32は32bit版オブジェクトに使われます。≫
  
  ref: https://llvm.org/docs/CMake.html#frequently-used-cmake-variables

To Reproduce
≪再現するには≫
  Steps to reproduce the behavior:
  ≪この動作を再現するための手順：≫
  
  1. Specify MULTILIBS = "multilib:lib32" and DEFAULTTUNE_virtclass-multilib-lib32 = "armv7vethf-neon" in local.conf
     ≪「MULTILIBS = "multilib:lib32"」と「DEFAULTTUNE_virtclass-multilib-lib32 = "armv7vethf-neon"」をlocal.confの中で設定する≫
  2. Add meta-clang layer
     ≪meta-clangレイヤを追加する≫
  3. bitbake clang-cross-aarch64
     ≪bitbake clang-cross-aarch64を実行する≫
  4. add meta-browser and meta-rust layer
     ≪meta-browserとmeta-rustのレイヤを追加する≫
  4. bitbake firefox
     ≪bitbake firefoxを実行する≫
  6. See error
     ≪エラーが表示される≫
  
Error
≪エラー≫
  ≪以下、実際に出力されたエラーの全文が貼り付けられているが、ここでは省略。≫

Expected behavior
≪期待される挙動≫
  meta-clang's llvm-config can work with DEFAULTTUNE_virtclass-multilib-lib32 specified environment.
  ≪meta-clangのllvm-configが、「DEFAULTTUNE_virtclass-multilib-lib32」が指定された環境で動作すること。≫
  
  llvm-config points to ${RECIPE_SYSROOT}/usr/lib/clang/8.0.1/lib/linux/ but actual libclang libraries are put in   ${RECIPE_SYSROOT}/usr/lib64/clang/8.0.1/lib/linux/
  ≪llvm-configは「${RECIPE_SYSROOT}/usr/lib/clang/8.0.1/lib/linux/」を指定しますが、実際のlibclangライブラリは「${RECIPE_SYSROOT}/usr/lib64/clang/8.0.1/lib/linux/」に置かれます。≫
  
  LLVM insists that using LLVM_LIBDIR_SUFFIX to control installation directory suffix such as lib64 or lib32.
  ≪LLVMでは、インストール先ディレクトリーの末尾をlib64やlib32のように変えたい場合、LLVM_LIBDIR_SUFFIXを使う必要があります。≫
  
  We should handle library directory glitch it llvm-config with LLVM_LIBDIR_SUFFIX.
  ≪私達はLLVM_LIBDIR_SUFFIXを伴ったllvm-configのライブラリーの配置先ディレクトリーのずれに対処するべきでしょう。≫
  
Desktop (please complete the following information):
≪ビルド環境のデスクトップ機（以下の情報を埋めてください）≫
  
  * OS: Ubuntu
  * Version 16.04.6 LTS

Additional context
≪追加の情報≫
  (Updated) I'd encountered this issue during meta-browser's firefox recipe building.
  ≪（追記）私はこの問題に、meta-browserのFirefoxのレシピを使ってのビルド作業中に遭遇しました。≫
```

これは、筆者の同僚の畑ケさんがmeta-clangというプロジェクトに対して行ったフィードバックです。

### フィードバックの経緯

組み込み機器向けにカスタマイズしたLinuxディストリビューションを作成するためのツールセットの一種であるYoctoでは、そのLinuxディストリビューションに組み込めるパッケージが多数公開されており、C言語のコンパイラであるclangを組み込むための設定ファイルやスクリプトを提供しているのが、meta-clangというプロジェクトです。畑ケさんがとある組み込みボード[^embedded-board]用にFirefoxをビルドしようとして、Firefoxのビルドに必要なmeta-clangを構成に入れたところ、ビルド結果が想定通りにならず、Firefoxパッケージをビルドできないという状況に遭遇しました。

[^embedded-board]: 複合機やカーナビなどの制御に使われるコンピューター。

この時点で原因がmeta-clangにあるということは明らかだったため、畑ケさんはとりあえずの回避策を手元で講じた上で、問題に遭遇したということをmeta-clangにフィードバックしました。すると、その報告に対してプロジェクトオーナーから「Can you cook up a patch?（パッチを作ってもらえませんか？）」とコメントが帰ってきました。そこで、畑ケさんは「I'm cooking up patches....（今パッチを作成中です……）」とコメントした上で、手元で行っていた暫定的な回避策を一般公開できるようにより洗練させ、プルリクエストしました。

その後パッチがマージされたことで、この報告もクローズされています。

### 注目したい点

これも、「自分の手元でなんとかして動くようにした」というところで終わらせないで、アップストリームに報告した事例です。

最終的にプルリクエストを出すところにまで至っていますが、畑ケさんは当初はそこまでするつもりはありませんでした。しかし「パッチを作ってもらえませんか？」と逆に依頼されたことがきっかけとなり、プルリクエストの作成に至りました。フィードバックは「自分にできることをまずはやる」所から始めるとよいですが、やろうと思っていなかったことに挑戦する機会にもなるということの好例と言えるでしょう。

この報告はプロジェクトのイシューテンプレートに基づいて書かれていているため、見出しの立て方が本書で紹介しているパターンとは異なっています。しかしながら、「To Reproduce」には再現手順と実際の結果が、「Expected behavior」には期待される結果が書かれており、本書で挙げている基本の3要素がきちんと含まれていることが分かります。

フィードバックする前の予備調査の時点で、畑ケさんはこの作者の人が、ここで使おうとしている「MULTILIBS」という機能を使っていないようだということを把握していました。そのため、再現手順や環境の作り方をより細かく具体的に書き、作者が容易に現象を確認できるようにすることを意識したそうです。

文中に登場している「glitch」という単語は、辞書では「故障」「誤動作」「異常」といった意味と出ますが、語源は「slip（滑る）」や「slide（ずらす）」と同じで、ニュアンスとしては「本来の正常な状態からずれてしまっている」状態を表すそうです。インデントのずれや画像の位置ずれなどにも使える表現ということで、覚えておくとよいでしょう。

ところで、以下の文のおかしいところに皆さんは気が付かれましたか？

> We should handle library directory glitch it llvm-config with LLVM_LIBDIR_SUFFIX.

実はこの文の「it」は誤記で、「in」が正しいです。熟練者でもこのようなミスタイプが残ったまま報告してしまうことがあると思うと、皆さんも、英語の間違いを過度に恐れる必要はないのだなと勇気づけられるのではないでしょうか[^victim]。

[^victim]: 畑ケさん本人にこの事を知らせると「やっちまったぁぁ」と恥ずかしがっておられましたが、本書でフィードバック初心者の方に勇気を持ってもらうための礎になっていただきました。合掌。


## よいフィードバック：Node.jsへのコントリビュート解説

[Node.jsへのコントリビュート解説、そしてOSSへ貢献するということ - 別にしんどくないブログ](https://shisama.hatenablog.com/entry/2019/12/04/204400#%E8%8B%B1%E8%AA%9E%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6)


## 悪いフィードバック：故意の炎上

[1601164 - Add tabs-on-bottom mode](https://bugzilla.mozilla.org/show_bug.cgi?id=1601164)


## 悪いフィードバック：プロジェクトの背景を踏まえないハックの提案

筆者も、過去に強引な実装のパッチを代理で投稿してもらった事がありましたが、実装の筋が悪すぎたためか、それ以上話が進む事はありませんでした。

[61846 - Undockable My Sidebar - in a new window](https://bugzilla.mozilla.org/show_bug.cgi?id=61846)
